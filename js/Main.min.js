let stringUtil=new StringUtil,generator=new GraphQLSpringGenerator,sqlParser=new SQLParser,util=new GraphQLSchemaUtils,entityRenderer,updatedWidth=600,drawRelationship=!0;function autopopulateDriverAndDialect(e){let t=document.getElementById("dbDriver"),r=document.getElementById("dbDialect");e.startsWith("jdbc:mysql:")?(t.value="com.mysql.cj.jdbc.Driver",r.value="org.hibernate.dialect.MySQL8Dialect"):e.startsWith("jdbc:mariadb:")?(t.value="org.mariadb.jdbc.Driver",r.value="org.hibernate.dialect.MariaDBDialect"):e.startsWith("jdbc:postgresql:")?(t.value="org.postgresql.Driver",r.value="org.hibernate.dialect.PostgreSQLDialect"):e.startsWith("jdbc:sqlite:")?(t.value="org.sqlite.JDBC",r.value="org.hibernate.dialect.SQLiteDialect"):e.startsWith("jdbc:oracle:")?(t.value="oracle.jdbc.OracleDriver",r.value="org.hibernate.dialect.Oracle12cDialect"):e.startsWith("jdbc:sqlserver:")?(t.value="com.microsoft.sqlserver.jdbc.SQLServerDriver",r.value="org.hibernate.dialect.SQLServer2012Dialect"):e.startsWith("jdbc:h2:")?(t.value="org.h2.Driver",r.value="org.hibernate.dialect.H2Dialect"):e.startsWith("jdbc:derby:")?(t.value="org.apache.derby.jdbc.EmbeddedDriver",r.value="org.hibernate.dialect.DerbyDialect"):e.startsWith("jdbc:db2:")?(t.value="com.ibm.db2.jcc.DB2Driver",r.value="org.hibernate.dialect.DB2Dialect"):e.startsWith("jdbc:firebird:")?(t.value="org.firebirdsql.jdbc.FBDriver",r.value="org.hibernate.dialect.FirebirdDialect"):e.startsWith("jdbc:sybase:")&&(t.value="com.sybase.jdbc4.jdbc.SybDriver",r.value="org.hibernate.dialect.SybaseDialect")}function autopopulatePackage(e){let t=document.getElementById("groupId"),r=document.getElementById("artifactId"),a=document.getElementById("serviceName"),i=e.trim();if(!i){t.value="",r.value="",a.value="";return}t.value=i;let l=i.split("."),d=l[l.length-1];r.value=d,a.value=d.split(/[-_]/).map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function applyModel(e){let t=document.getElementById("maxRelationDepth"),r=Math.max(...e.entities.map(e=>e.depth))-1;t.value=r,generator.setModel(e)}let resizeTimeout;window.addEventListener("resize",()=>{clearTimeout(resizeTimeout),resizeTimeout=setTimeout(()=>{let e=document.querySelector(".erd-wrapper");if(e){let t=e.clientWidth;t<480&&(t=480),entityRenderer.createERD(generator.getModel(),t,drawRelationship),entityRenderer.createDescription(generator.getModel(),"#erd-description")}},30)}),document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("configForm"),t=document.getElementById("packageName"),r=document.getElementById("dbUrl"),a=document.getElementById("sqlFile");(entityRenderer=new EntityRenderer(".erd-svg")).initIconEvent(generator);let i=document.querySelector(".erd-wrapper");i&&(updatedWidth=i.clientWidth),t.addEventListener("change",function(e){autopopulatePackage(e.target.value)}),t.addEventListener("keyup",function(e){autopopulatePackage(e.target.value)}),r.addEventListener("change",function(e){autopopulateDriverAndDialect(e.target.value)}),r.addEventListener("keyup",function(e){autopopulateDriverAndDialect(e.target.value)}),a.addEventListener("change",function(t){let r=new FormData(e),a=r.get("sqlFile");a&&sqlParser.importSQLFile(a,e=>{e.entities=e.entities.filter(e=>"sqlite_sequence"!==e.name),applyModel(e),updatedWidth<480&&(updatedWidth=480),entityRenderer.createERD(e,updatedWidth,drawRelationship),entityRenderer.createDescription(e,"#erd-description")})});let l=new FormData(e),d=l.get("sqlFile");d&&sqlParser.importSQLFile(d,e=>{e.entities=e.entities.filter(e=>"sqlite_sequence"!==e.name),applyModel(e),updatedWidth<480&&(updatedWidth=480),entityRenderer.createERD(e,updatedWidth,drawRelationship),entityRenderer.createDescription(e,"#erd-description")}),e.addEventListener("submit",t=>{t.preventDefault();let r=new FormData(e),a={packageName:r.get("packageName"),groupId:r.get("groupId"),artifactId:r.get("artifactId"),serviceName:r.get("serviceName"),serviceDescription:r.get("serviceDescription"),javaVersion:r.get("javaVersion"),version:r.get("version"),maxRelationDepth:parseInt(r.get("maxRelationDepth"))||3};generator.createZipFile(null,a,document.querySelector("#artifactId").value+".zip")})});