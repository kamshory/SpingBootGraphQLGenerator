class Entity{constructor(t,e){this.index=e,this.name=t,this.columns=[],this.data=[],this.description="",this.creationDate=null,this.modificationDate=null,this.creator=null,this.modifier=null}addColumn(t){this.columns.push(t)}removeColumn(t){this.columns.splice(t,1)}setData(t){this.data=t||[]}countPrimaryKey(){return this.columns.filter(t=>t.primaryKey).length}getPrimaryKeyColumns(){return this.columns.filter(t=>t.primaryKey).map(t=>t.name)}getPrimaryKeyColumnsAsString(t="mysql"){let e=this.getPrimaryKeyColumns();return"mysql"===t?e.map(t=>`\`${t}\``).join(", "):e.join(", ")}toSQL(t="mysql"){let e=this.countPrimaryKey()>1,r=[],l=`CREATE TABLE IF NOT EXISTS ${this.name} (\r
`;return this.columns.forEach(l=>{r.push(`	${l.toSQL(t,e)}`)}),e&&r.push(`	PRIMARY KEY(${this.getPrimaryKeyColumnsAsString(t)})`),l+=r.join(",\r\n"),l+="\r\n);\r\n\r\n"}toSQLInsert(t="mysql",e=100){if(!this.data||0===this.data.length)return"";let r=this.columns.map(t=>t.name),l=[];for(let s=0;s<this.data.length;s+=e){let n=this.data.slice(s,s+e),i=n.map(e=>"("+r.map(r=>{let l=this.columns.find(t=>t.name===r),s=!!l&&l.nullable;return this.formatValue(e[r],l,t,s)}).join(", ")+")"),a=`INSERT INTO ${this.name} (${r.join(", ")}) VALUES
${i.join(",\n")};\r
`;l.push(a)}return l.join("\n")}createInsert(t,e){let r=e.join(", "),l=e.map(e=>{let r=this.columns.find(t=>t.name===e),l=!r||r.nullable;return this.formatValue(t[e],r,"mysql",l)}).join(", ");return`INSERT INTO ${this.name} (${r}) VALUES (${l});`}formatValue(t,e,r="mysql",l=!0){let s=e.type.toLowerCase(),n=e.length,i=e.isTypeText(s),a=e.isTypeInteger(s),o=e.isTypeFloat(s),u=e.isTypeBoolean(s,n),m=null==t||"string"==typeof t&&""===t.trim()||!i&&"null"===String(t).toLowerCase();return m?l?"null":void 0!==e.default&&null!==e.default?this.formatValue(e.default,e,r,!0):u?this.formatBoolean(t,r,!1,e.default):a||o?"0":"''":u?this.formatBoolean(t,r,l,e.default):a||o?t.toString():this.quoteString(t,r)}formatBoolean(t,e="mysql",r=!0,l=null){let s=null==t||"string"==typeof t&&""===t.trim()||"string"==typeof t&&"null"===t.trim().toLowerCase();if(s)return r?"null":null!=l?this.formatBoolean(l,e,!1):"postgresql"===e.toLowerCase()?"false":"0";let n=String(t).toLowerCase().trim(),i="true"===n||"1"===n||"yes"===n||"on"===n;return"postgresql"===e.toLowerCase()?i?"true":"false":i?"1":"0"}quoteString(t,e="mysql"){let r=String(t);switch(r=r.replace(/'/g,"''"),e.toLowerCase()){case"mysql":default:r=r.replace(/\\/g,"\\\\");break;case"postgresql":return`E'${r=r.replace(/\\/g,"\\\\")}'`;case"sqlite":case"sqlserver":}return`'${r}'`}}